# xss

xss 深入学习

### xss定义


> xss 跨站脚本攻击， 是指发生在目标用户的浏览器层面上的，当渲染DOM树的过程成发生了不在预期内执行的JS代码时，就发生了XSS攻击。跨站脚本的重点不在‘跨站’上，而在于‘脚本’上。大多数XSS攻击的主要方式是嵌入一段远程或者第三方域上的JS代码。实际上是在目标网站的作用域下执行了这段js代码。

## XSS攻击方式

### 反射型

> 发出请求是,XSS代码出现在URL中,作为输入提交到服务器端,服务器端解析后响应,XSS代码随着响应内容一起传回浏览器,最后浏览器解析执行XSS代码。这个过程像一次反射,故叫做反射型XSS。


### 存储型

> 存储型XSS和反射型XSS的差别在于,提交的代码会存储在服务器中(例如数据库,内存,文件系统等),下次请求页面是不用再提交XSS代码。

### XSS防御

#### 对cookie的保护

1. 对重要的cookie设置httpOnly, 防止客户端通过document.cookie读取cookie。服务端可以设置此字段。


### 对用户输入数据的处理 

1. 编码： 对用户输入的html进行编码。

2. 过滤： 移除用户上传的所有dom属性和事件，移除style节点，script节点，iframe节点等。

3. 校正： 避免直接解码，使用dom parse转换，校正不匹配的dom标签。
